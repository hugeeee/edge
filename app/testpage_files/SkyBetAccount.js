!function(e){if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.SkyBetAccount=e()}}(function(){return function e(t,n,i){function o(r,a){if(!n[r]){if(!t[r]){var u="function"==typeof require&&require;if(!a&&u)return u(r,!0);if(s)return s(r,!0);throw new Error("Cannot find module '"+r+"'")}var c=n[r]={exports:{}};t[r][0].call(c.exports,function(e){var n=t[r][1][e];return o(n?n:e)},c,c.exports,e,t,n,i)}return n[r].exports}for(var s="function"==typeof require&&require,r=0;r<i.length;r++)o(i[r]);return o}({1:[function(e,t){function n(){}var o=e("./module/Affiliates"),s=e("./module/AppBridge"),r=e("./module/Bus"),a=e("./module/Events"),u=e("./module/InitialLoader"),c=e("./module/Log"),l=e("./module/UI");bus=null,a.call(n.prototype),n.prototype.AppBridgeClass=s,n.prototype.POLL_PERIOD_COOKIE_NAME="__SBA_POLLTIME",n.prototype.Timeout={GET_OXI_TOKEN:1e4,GET_SSO_TRANSFER_TOKEN:1e4,BG_VERIFICATION:1e4,REDEEM_CODE:1e4},n.prototype.APP_USER_AGENT_EXTENSIONS=["SkyVegas","SkyBet","SkySuper6","SkyFantasyFootball","SkyBingo","SkyPoker","SkyCasino","SkySixASide"],n.prototype.setup=function(e){this.eventsBind=this.bind;var t=this;if(this.bind=function(e,n){this.eventsBind(e,n),"appBridgeReady"===e&&t.fire("appBridgeReady",{appBridge:t.getAppBridge()})},!e.consumer)throw new Error("SkyBetAccount.setup expects options.consumer");if(!e.consumerUrl)throw new Error("SkyBetAccount.setup expects options.consumerUrl");this.config={consumer:null,consumerUrl:null,host:"www.skybet.com",scheme:"https",window:"undefined"!=typeof window?window:null,hasCookies:!1,pollPeriod:300,deeplinkParam:"open",appBridge:!1,allowsRefresh:!1},this.eventStack=[];for(var n in e)n in this.config&&e.hasOwnProperty(n)&&(this.config[n]=e[n]);this.config.consumerUrl=this.config.consumerUrl.replace(/\/$/,""),this.window=this.config.window,function(e,t){function n(e){var n=t[e];t[e]=function(e){return s(n(e))}}function i(t,n,i){return(i=this).attachEvent("on"+t,function(t){var t=t||e.event;t.preventDefault=t.preventDefault||function(){t.returnValue=!1},t.stopPropagation=t.stopPropagation||function(){t.cancelBubble=!0};try{n.call(i,t)}catch(t){}})}function o(t,n,i){return(i=this).detachEvent("on"+t,function(t){var t=t||e.event;t.preventDefault=t.preventDefault||function(){t.returnValue=!1},t.stopPropagation=t.stopPropagation||function(){t.cancelBubble=!0};try{n.call(i,t)}catch(t){}})}function s(e,t){if(t=e.length)for(;t--;)e[t].addEventListener=i,e[t].removeEventListener=o;else e.addEventListener=i,e.removeEventListener=o;return e}e.addEventListener||(s([t,e]),"Element"in e?(e.Element.prototype.addEventListener=i,e.Element.prototype.removeEventListener=o):(t.attachEvent("onreadystatechange",function(){s(t.all)}),n("getElementsByTagName"),n("getElementById"),n("createElement"),s(t.all)))}(this.window,this.window.document),this.log=new c(this),this.affiliates=new o(this.window.document.location.search,this.window.document,this.config);var i=this.affiliates.getQueryVar("sba_promo");null!==i&&this.affiliates.addCookie("PROMO_CODE",i);var s=this.affiliates.getQueryVar("sba_transferToken");this.ssoTransferToken=null===s?"":s,this.initialLoader=new u(this.config,this);var a=this;this.bus=bus=new r(this.config),this.ui=new l(this.window,this.bus,function(){return a.getUrl.apply(a,arguments)},this),this.bindConsumerEvents(),this.bindInternalEvents(),this.window.SkyBetAccountJsonp=function(e){switch(e.method){case"get-oxi-token":a.bus.fire(r.Events.OXI_TOKEN,e);break;case"verify-user-and-get-oxi-token":a.bus.fire(r.Events.BG_VERIFICATION,e);break;case"redeem-code":a.bus.fire(r.Events.REDEEM_CODE,e);break;case"get-sso-transfer-token":a.bus.fire(r.Events.SSO_TRANSFER_TOKEN,e)}},this.init()},n.prototype.init=function(){var e=this.getPollPeriodCookie(),t=0;if(e&&e.timestamp&&"true"===e.hasMyAccountCookies){var n=(new Date).getTime();t=n-e.timestamp}var i=this.affiliates.getQueryVar("sba_skipThrottle");return 0!==t&&t<=1e3*this.config.pollPeriod&&""===this.ssoTransferToken&&"true"!==i?(this.config.hasCookies=e.hasMyAccountCookies,this.fire("hasCookies",this.config.hasCookies),this.initialLoader.checkDeeplink(),this):(this.affiliates.setAffilliateCookies(),this.ui.getMenu(),this)},n.prototype.getAppBridge=function(e){if(!this.config)throw new Error("SkyBetAccount.getAppBridge requires SkyBetAccount.setup to have been called");return this.appBridge||(this.appBridge=new s(this),this.appBridge.setConfig(e)),this.appBridge},n.prototype.getAppName=function(){var e=this.window.navigator.userAgent;for(i in this.APP_USER_AGENT_EXTENSIONS)if(-1!==e.indexOf(this.APP_USER_AGENT_EXTENSIONS[i]))return this.APP_USER_AGENT_EXTENSIONS[i];return null},n.prototype.getPollPeriodCookie=function(){var e=this.window.document.cookie.match(new RegExp("(?:^|;)\\s*"+this.POLL_PERIOD_COOKIE_NAME+"=([^;\\s]*)"));if(!(e instanceof Array&&e.length))return null;e=e[1];var t="string"==typeof e?unescape(e).split("|"):null;return t?{timestamp:t[0],loginState:t[1],hasMyAccountCookies:t[2]||"false",notificationToken:t[3]||null}:null},n.prototype.updatePollPeriodCookie=function(e){var t="loggedOut";this.lastLoginState&&this.lastLoginState.name&&(t=this.lastLoginState.name);var n=(new Date).getTime(),i=this.POLL_PERIOD_COOKIE_NAME+"="+n+"|"+t+"|"+this.config.hasCookies;if(e)i=i+"|"+e;else if(void 0===e){var o=this.getPollPeriodCookie();o&&o.notificationToken&&(i=i+"|"+o.notificationToken)}return this.window.document.cookie=i+";Path=/;",this},n.prototype.clearPollPeriodCookie=function(){return this.window.document.cookie=this.POLL_PERIOD_COOKIE_NAME+"=;Path=/;Expires=Thu, 01 Jan 1970 00:00:01 GMT;",this},n.prototype.bindConsumerEvents=function(){var e=this;this.bus.bind(r.Events.LOGGED_IN,function(t){e.lastLoginState=t,e.fire("loggedIn",t),e.updatePollPeriodCookie()}),this.bus.bind(r.Events.QUEUE_UP_EVENT,function(t){"loggedIn"===t.data.name&&e.clearPollPeriodCookie(),e.eventStack[t.event]=t.data}),this.bus.bind(r.Events.LOGGED_OUT,function(t){e.lastLoginState=t,t.userInteraction&&(e.ui.getMenu().url=null),e.fire("loggedOut",t),e.updatePollPeriodCookie()}),this.bus.bind(r.Events.USER_DATA_CHANGE,function(t){e.fire("userDataChange",t)}),this.bus.bind(r.Events.FULL_REGISTRATION,function(t){e.fire("fullRegistrationComplete",t)}),this.bus.bind(r.Events.DEPOSIT_COMPLETE,function(t){e.fire("depositComplete",t)}),this.bus.bind(r.Events.WITHDRAWAL_COMPLETE,function(t){e.fire("withdrawalComplete",t)}),this.bus.bind(r.Events.REDEEM_PROMO_CODE,function(t){e.fire("redeemPromoCode",t)}),this.bus.bind(r.Events.SELF_EXCLUSIONS_UPDATE,function(t){e.fire("selfExclusionsUpdate",t)}),this.bus.bind(r.Events.COOL_OFF_UPDATE,function(t){e.fire("coolOffUpdate",t)}),this.bus.bind(r.Events.PREFERENCES_UPDATE,function(t){e.fire("preferencesUpdate",t)}),this.bus.bind(r.Events.AGE_VERIFICATION,function(t){e.fire("ageVerificationComplete",t)}),this.bus.bind(r.Events.REDEEM_CODE,function(t){e.fire("redeemCode",t)}),this.bus.bind(r.Events.OPTIN_TRIGGER,function(t){e.fire("optinTrigger",t)}),this.bus.bind(r.Events.NAVIGATE,function(t){e.fire("navigate",t)});var t=function(t){e.fire("showModalDialog",t)};this.bus.bind(r.Events.SHOW_MODAL_DIALOG,t),this.ui.bind(r.Events.SHOW_MODAL_DIALOG,t),this.bus.bind(r.Events.MYACCOUNT_PAGE_READY,function(){var t={};t[r.Events.SHOW_MODAL_DIALOG]=e.hasBoundEvent(r.Events.SHOW_MODAL_DIALOG),e.bus.postMessage(e.ui.getMenu().iframe.contentWindow,{type:"Event",event:{name:"consumerAvailable",data:t}})}),this.bus.bind(r.Events.HEALTH_CHECK_OK,function(t){e.fire("healthCheckOk",t),e.ui.getMenu().redirect("loginState",null,!0)}),this.bus.bind(r.Events.GET_DATA_FOR_DEPOSIT,function(){var t={currentConsumerUrl:e.getCurrentConsumerUrl(),deeplinkParam:e.config.deeplinkParam};e.bus.postMessage(e.ui.menu.iframe.contentWindow,{type:"Event",event:{name:"dataForDeposit",data:t}})}),this.bus.bind(r.Events.GET_SSO_TRANSFER_TOKEN,function(){e.getSsoTransferToken(function(t,n){n&&e.bus.postMessage(e.ui.menu.iframe.contentWindow,{type:"Event",event:{name:"getSsoTransferToken",data:{token:n}}})})}),this.bus.bind(r.Events.APPBRIDGE_TRIGGER,function(t){var n=e.getAppBridge();n.trigger(t.event,t.data)}),this.ui.bind(l.Events.CLOSE,function(){e.bus.postMessage(e.ui.getMenu().iframe.contentWindow,{type:"Event",event:{name:"disableInteraction"}}),e.fire("close")}),this.ui.bind(l.Events.OPEN,function(){e.fire("open",{height:e.ui.height})}),this.ui.bind(l.Events.RENDERED,function(){e.bus.postMessage(e.ui.getMenu().iframe.contentWindow,{type:"Event",event:{name:"enableInteraction"}})})},n.prototype.bindInternalEvents=function(){var e=this;this.bus.bind(r.Events.PAGE_READY,function(t){return e.ui.getMenu().url=t.url,t.url===e.ui.getUrl("login")&&(e.ui.loginToken=(new Date).getTime()),e.ui.isPreloading?(e.ui.applyOnPreloadCallbacks(),void 0):(e.ui.isOpen?e.ui.ready():e.ui.getMenu().redirect("loginState",null,!0),e.isExternalUrl=function(t){if("undefined"==typeof t)return!1;var n=t.replace("http://","").replace("https://","").split("/")[0];return e.config.host!=n}(t.url),void 0)}),this.bus.bind(r.Events.ALLOW_REFRESH,function(){e.config.allowsRefresh=!0}),this.bus.bind(r.Events.OPEN_MY_ACCOUNT,function(){e.fire("openMyAccount")}),this.bus.bind(r.Events.APP_LOGIN_ATTEMPTED,function(t){e.getAppBridge().trigger("login-attempted",t),t.success&&e.getAppBridge().trigger("quickpinShowObModal",{autoEnabledQuickPIN:1==t.rememberMe})}),this.bus.bind(r.Events.CLOSE_MY_ACCOUNT,function(){e.closeMyAccount(),e.getAppBridge().trigger("myAccount.closed",{})}),this.bus.bind(r.Events.SCROLL_TO,function(t){e.ui.scrollTo(t.value)}),this.bus.bind(r.Events.INITIAL_PAGE,function(){return e.initialPageLoaded?e.ui.close():(e.initialPageLoaded=!0,e.initialLoader.checkDeeplink(),void 0)}),this.bus.bind(r.Events.SET_LOADING_OVERLAY,function(t){t.value&&!e.ui.isPreloading?e.ui.showLoadingOverlay(t.secure):e.ui.hideLoadingOverlay()}),this.bus.bind(r.Events.HAS_COOKIES,function(t){if("hasCookies"in t){e.config.hasCookies=t.hasCookies,e.updatePollPeriodCookie();var n;"ssoTransferToken"in t&&(n=t.ssoTransferToken);var i=e.affiliates.getQueryVar("sba_transferToken"),o=e.affiliates.getQueryVar("sba_transferTokenRedirect");if(!e.config.hasCookies&&i&&""!==i&&null===o){var s=e.getCurrentConsumerUrl();"undefined"!=typeof n&&(s=s.replace(/sba_transferToken=[a-z0-9]{32}/g,"sba_transferToken="+n)),s+=s.indexOf("?")?"&":"?",s+="sba_transferTokenRedirect=1";var r=e.getUrl("fullScreenRedirect","static")+"returnUrl="+encodeURIComponent(s);return e.window.top.location.replace(r)}e.fire("hasCookies",t.hasCookies)}})},n.prototype.processAppBridgeNotificationToken=function(e){this.updatePollPeriodCookie(e.token);var t="app="+encodeURIComponent(this.config.consumer)+"&deviceName="+encodeURIComponent(e.deviceName)+"&deviceVersion="+encodeURIComponent(e.deviceVersion)+"&appVersion="+encodeURIComponent(e.appVersion)+"&token="+encodeURIComponent(e.token);this.sendNotificationTokenRequest(t,function(){}),"loggedIn"==this.getLastLoginState()&&this.processNotificationTokenOnLogin(this.lastLoginState)},n.prototype.processNotificationTokenOnLogin=function(e){var t=this.getPollPeriodCookie();if(t&&t.notificationToken){var n="app="+encodeURIComponent(this.config.consumer)+"&customerId="+encodeURIComponent(e.user.customerId)+"&token="+encodeURIComponent(t.notificationToken);this.sendNotificationTokenRequest(n,function(e){200==e.status&&this.updatePollPeriodCookie(null)}.bind(this))}},n.prototype.sendNotificationTokenRequest=function(e,t){var n=this.config.scheme+"://"+this.config.host+"/secure/identity/app/notification-token",i=new XMLHttpRequest;i.open("POST",n,!0),i.setRequestHeader("Content-type","application/x-www-form-urlencoded"),i.onreadystatechange=function(){4==i.readyState&&t(i)},i.send(e)},n.prototype.remoteNotificationActioned=function(e){var t=e.userInfo||{},n=[{type:"business",name:this.config.consumer+".app.remoteNotificationActioned",data:{deviceName:e.deviceName||"",deviceVersion:e.deviceVersion||"",appVersion:e.appVersion||"",token:e.token||"",customerid:t.user||"",campaign:t.campaign||""}}];this.log.sendLogEvents(n)},n.prototype.navbarResendPageUrl=function(){this.ui.isOpen&&this.bus.postMessage(this.ui.getMenu().iframe.contentWindow,{type:"Event",event:{name:r.Events.SEND_PAGE_URL,data:{}}})},n.prototype.navbarLoadPage=function(e){e.ident&&("account-login"===e.ident?this.openLogin():"account-registration"===e.ident?this.openRegistration():this.closeMyAccount())},n.prototype.isInitialPageLoaded=function(){return this.initialPageLoaded?!0:!1},n.prototype.getUrl=function(e,t,n,i){t=t||"mobile",i=i||!1;var o={mobile:"https://{host}/secure/identity/",web:"https://{host}/secure/","static":"https://{host}/"},s={account:"m/myaccount/{consumer}?urlconsumer={consumerUrl}&dl=1",addCard:"m/add-card/{consumer}",applyPromotion:"m/redeem-code/{consumer}",optinTrigger:"m/optin-trigger/{consumer}",completeDeposit:"complete-deposit-handler/{consumer}?returnUrl=/secure/identity/m/deposit/completed/{consumer}",bankingHistory:"m/history/financial",bettingHistory:"m/history/betting",bgverification:"m/verify-user-and-get-oxi-token/{consumer}",deposit:"m/choose-deposit-method/{consumer}?urlconsumer={consumerUrl}&dl=1",faq:"m/faq/{consumer}",fullScreenRedirect:"secure/identity/redirector/{consumer}?",gamingHistory:"m/history/gaming",getSsoTransferToken:"m/get-sso-transfer-token/{consumer}",healthCheck:"m/health-check/{consumer}?urlconsumer={consumerUrl}&dl=1",loginState:"m/login-state/{consumer}?urlconsumer={consumerUrl}&dl=1&ssoTransferToken={ssoTransferToken}",login:"m/login/{consumer}?urlconsumer={consumerUrl}&dl=1",logout:"logout?consumer={consumer}&urlconsumer={consumerUrl}&mobile=1&dl=1",managePaymentMethods:"m/manage-payment-methods/{consumer}",oxiToken:"m/get-oxi-token/{consumer}",promotion:"m/promotions/redeem-code/{consumer}",quickDeposit:"m/deposit/{consumer}?urlconsumer={consumerUrl}&dl=1",recoverMenu:"m/recover/{consumer}",recoverPin:"m/recover/pin/{consumer}",recoverUser:"m/recover/user?consumer={consumer}",registration:"m/register/step-1/{consumer}?dl=1&urlconsumer={consumerUrl}",resetTempPin:"m/reset-temp-pin?consumer={consumer}&urlconsumer={consumerUrl}",transactionsUnsettled:"m/history/betting?settled=N",unlockAccount:"m/unlock-account?consumer={consumer}&urlconsumer={consumerUrl}",upgradeReg:"m/upgrade/step-1/{consumer}",verification:"m/verification/choose-document/{consumer}",withdrawal:"m/choose-withdrawal-method/{consumer}?urlconsumer={consumerUrl}&dl=1",selfExclude:"m/self-exclude/{consumer}",changePin:"m/edit-pin/{consumer}"};if(!s[e])return!1;var r=o[t]+s[e],a={host:this.config.host,consumer:this.config.consumer,consumerUrl:this.config.consumerUrl,ssoTransferToken:this.ssoTransferToken};i&&(r=r.slice(o["static"].length-1));for(var u in a)a.hasOwnProperty(u)&&(r=r.replace(new RegExp("{"+u+"}","g"),a[u]));if("object"==typeof n&&null!==n){var c="?";-1!==r.indexOf("?")&&(c="&");for(e in n){var l=n[e];"object"==typeof l&&(l=JSON.stringify(l)),c+=e+"="+l+"&"}return r+c}return r},n.prototype.getRegistrationUrl=function(e,t){return this.getUrl("registration",e,t)},n.prototype.getLoginUrl=function(){return this.getUrl("login")},n.prototype.getAccountUrl=function(){return this.getUrl("account")},n.prototype.getLoginTarget=function(){return"SkyBetAccount"},n.prototype.openRegistration=function(e,t,n){return this.ui.open("registration",e,null,t,n),this},n.prototype.openLogin=function(e){if("undefined"!=typeof document){var t=document.cookie.match(/sbgCAtrial01=([^;$]+)/);if(null!==t){t=t[1].split(",");for(i in t)if("lifdelay"==t[i]){var n=this.ui;return n.overlay.show(),n.showLoadingOverlay(),window.setTimeout(function(){n.open("login",e)},500),this}}}return this.ui.open("login",e),this},n.prototype.openExternalUrl=function(e,t){var n=function(){this.ui.ready(),this.ui.scrollTo(0)}.bind(this);return this.ui.open(e,n,!0,null,null,t),this},n.prototype.closeMyAccount=function(){this.isExternalUrl&&this.ui.menu.redirect("loginState",null,!0);var e=this.eventStack;for(_event in e)e.hasOwnProperty(_event)&&(this.fire(_event,e[_event]),delete e[_event]);this.ui.close()},n.prototype.requiresFullScreenRedirect=function(){return!1},n.prototype.openMyAccount=function(e){return this.ui.open("account",e),this},n.prototype.openDeposit=function(e){return this.ui.open("deposit",e),this},n.prototype.openQuickDeposit=function(e){return this.ui.open("quickDeposit",e),this},n.prototype.openCompleteDeposit=function(e,t,n){return this.ui.open("completeDeposit",e,t,n),this},n.prototype.openVerification=function(e){return this.ui.open("verification",e),this},n.prototype.openUpgradeReg=function(e){var t;return this.lastLoginState&&"name"in this.lastLoginState?t=this.lastLoginState.name:this.getPollPeriodCookie()&&"loginState"in this.getPollPeriodCookie()&&(t=this.getPollPeriodCookie().loginState),"loggedIn"===t?this.ui.open("upgradeReg",e):this.ui.open("login",e),this},n.prototype.openPromotion=function(e){return this.ui.open("promotion",e),this},n.prototype.openRecoverPin=function(e){return this.ui.open("recoverPin",e),this},n.prototype.openAddCard=function(e){return this.ui.open("addCard",e),this},n.prototype.openManagePaymentMethods=function(e){return this.ui.open("managePaymentMethods",e),this},n.prototype.openWithdrawal=function(e){return this.ui.open("withdrawal",e),this},n.prototype.openBettingHistory=function(e){return this.ui.open("bettingHistory",e),this},n.prototype.openGamingHistory=function(e){return this.ui.open("gamingHistory",e),this},n.prototype.openBankingHistory=function(e){return this.ui.open("bankingHistory",e),this},n.prototype.openRecoverMenu=function(e){return this.ui.open("recoverMenu",e),this},n.prototype.openRecoverUser=function(e){return this.ui.open("recoverUser",e),this},n.prototype.openUnlockAccount=function(e){return this.ui.open("unlockAccount",e),this},n.prototype.openResetTempPin=function(e){return this.ui.open("resetTempPin",e),this},n.prototype.openFaq=function(e){return this.ui.open("faq",e),this},n.prototype.openSelfExclude=function(e){return this.ui.open("selfExclude",e),this},n.prototype.openChangePin=function(e){return this.ui.open("changePin",e),this},n.prototype.modalDialogDismissed=function(e){return this.bus.postMessage(this.ui.getMenu().iframe.contentWindow,{type:"Event",event:{name:"modalDialogDismissed",data:e}}),this},n.prototype.openOverlay=function(e){return this.ui.open(null,e),this},n.prototype.openTransactionHistoryUnsettled=function(e){return this.ui.open("transactionsUnsettled",e),this},n.prototype.getOxiToken=function(e){var t=this,n=setTimeout(function(){t.bus.unbind(r.Events.OXI_TOKEN),e({code:8,message:"Request timed out"})},this.Timeout.GET_OXI_TOKEN),i=function(i){clearTimeout(n),0==i.code?e(null,i.data.token):e({code:i.code,message:i.message}),t.bus.unbind(r.Events.OXI_TOKEN)};this.bus.bind(r.Events.OXI_TOKEN,i);var o=this.ui.createElement("script");return o.src=this.getUrl("oxiToken"),this.ui.getElement("head").appendChild(o),this},n.prototype.getSsoTransferToken=function(e){var t=this,n=setTimeout(function(){t.bus.unbind(r.Events.SSO_TRANSFER_TOKEN),e({code:8,message:"Request timed out"})},this.Timeout.GET_SSO_TRANSFER_TOKEN),i=function(i){clearTimeout(n),0==i.code?e(null,i.data.ssoTransferToken):e({code:i.code,message:i.message}),t.bus.unbind(r.Events.SSO_TRANSFER_TOKEN)};this.bus.bind(r.Events.SSO_TRANSFER_TOKEN,i);var o=this.ui.createElement("script");return o.src=this.getUrl("getSsoTransferToken"),this.ui.getElement("head").appendChild(o),this},n.prototype.verifyUserAndGetOxiToken=function(e){var t=this;if(this.lastLoginState&&this.lastLoginState.user.ageverified)return this.getOxiToken(e);var n=setTimeout(function(){t.bus.unbind(r.Events.BG_VERIFICATION),e({code:8,message:"Request timed out"})},this.Timeout.BG_VERIFICATION),i=function(i){clearTimeout(n),0==i.code?(t.lastLoginState&&(t.lastLoginState.user.ageverified=!0),e(null,i.data.token)):e({code:i.code,message:i.message}),t.bus.unbind(r.Events.BG_VERIFICATION)};this.bus.bind(r.Events.BG_VERIFICATION,i);var o=this.ui.createElement("script");return o.src=this.getUrl("bgverification"),this.ui.getElement("head").appendChild(o),this},n.prototype.redeemCode=function(e,t){var n=this,i=setTimeout(function(){n.bus.unbind(r.Events.REDEEM_CODE),t({code:8,message:"Request timed out"})},this.Timeout.REDEEM_CODE),o=function(e){clearTimeout(i),0==e.code?t(null,!0):t({code:e.code,message:e.message}),n.bus.unbind(r.Events.REDEEM_CODE)};this.bus.bind(r.Events.REDEEM_CODE,o);var s=this.ui.createElement("script");return s.src=this.getUrl("applyPromotion",null,{code:e}),this.ui.getElement("head").appendChild(s),this},n.prototype.optinTrigger=function(e,t,n,i){var o=this,s=setTimeout(function(){o.bus.unbind(r.Events.OPTIN_TRIGGER),i({code:8,message:"Request timed out"})},this.Timeout.OPTIN_TRIGGER),a=function(e){clearTimeout(s),0==e.code?i(null,!0):i({code:e.code,message:e.message}),o.bus.unbind(r.Events.OPTIN_TRIGGER)};this.bus.bind(r.Events.OPTIN_TRIGGER,a);var u=this.ui.createElement("script");return u.src=this.getUrl("optinTrigger",null,{triggerValue:e,monetaryValue:t,channel:n}),this.ui.getElement("head").appendChild(u),this},n.prototype.getLoginState=function(e){return this.lastLoginState?e(null,this.lastLoginState):e({code:8,message:"Login state unknown"})},n.prototype.fireLoginState=function(){this.lastLoginState&&("loggedIn"===this.lastLoginState.name?this.fire("loggedIn",this.lastLoginState):this.fire("loggedOut",this.lastLoginState))},n.prototype.logout=function(e){var t=this;return this.ui.open("logout",function(){t.ui.close(),t.ui.hideLoadingOverlay(),e&&e()}),this},n.prototype.openUpgradeAccount=function(e){return this.openUpgradeReg(e),this},n.prototype.gotoLogin=function(e){this.ui.getMenu().redirect("login",null,e)},n.prototype.healthCheck=function(e){return this.ui.getMenu().redirect("healthCheck",e),this},n.prototype.preloadMyAccount=function(e){return this.ui.preload("account",e),this},n.prototype.getCurrentConsumerUrl=function(){return this.window.location.href},n.prototype.getLastLoginState=function(){if(this.lastLoginState)return this.lastLoginState.name||null;var e=this.getPollPeriodCookie();return e?e.loginState||null:null},Array.prototype.some||(Array.prototype.some=function(e){"use strict";if(null==this)throw new TypeError;var t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw new TypeError;for(var i=arguments[1],o=0;n>o;o++)if(o in t&&e.call(i,t[o],o,t))return!0;return!1}),Function.prototype.bind||(Function.prototype.bind=function(e){var t=this,n=Array.prototype.slice.call(arguments,1),i=function(){var o=function(){var e=function(){};return e.prototype=t.prototype,e}(),s=new o,r=t.apply(function(){return this instanceof i&&s?s:e}(),n.concat(Array.prototype.slice.call(arguments)));return r||s};return i}),t.exports=new n},{"./module/Affiliates":2,"./module/AppBridge":3,"./module/Bus":4,"./module/Events":6,"./module/InitialLoader":7,"./module/Log":9,"./module/UI":12}],2:[function(e,t){function n(e,t,n){this.queryString=e,this.document=t,this.config=n,this.queryVars=null,this.affCookie="AFF_ID",this.btagCookie="IBSAFFIA",this.assetIdCookie="IBSAFFASSET",this.affQueryVars=["a","aff","affid","aff_id"],this.btagQueryVar="btag",this.assetIdQueryVar="asset_id"}n.prototype.setAffilliateCookies=function(){for(var e in this.affQueryVars)if(this.affQueryVars.hasOwnProperty(e)&&null!==this.getQueryVar(this.affQueryVars[e])){var t=this.getQueryVar(this.affQueryVars[e]);break}var n=this.getQueryVar(this.btagQueryVar),i=this.getQueryVar(this.assetIdQueryVar);null!==t&&/^\d+$/.test(t)&&this.addCookie(this.affCookie,t),null!==n&&/^\S+$/.test(n)&&this.addCookie(this.btagCookie,n),null!==i&&/^\d+$/.test(i)&&this.addCookie(this.assetIdCookie,i)},n.prototype.addCookie=function(e,t){var n=document.getElementsByTagName("head")[0],i=document.createElement("link");i.rel="stylesheet",i.type="text/css",i.media="all",i.href="https://"+this.config.host+"/secure/identity/set-cookie?name="+e+"&value="+t,n.appendChild(i)},n.prototype.getQueryVars=function(){if(null===this.queryVars){for(var e=this.queryString.substring(1),t=e.split("&"),n={},i=0;i<t.length;i++){var o=t[i].split("=");n[o[0].toLowerCase()]=o[1]}this.queryVars=n}return this.queryVars},n.prototype.getQueryVar=function(e){e=e.toLowerCase();var t=this.getQueryVars(),n=t[e];return void 0===n&&(n=null),n},t.exports=n},{}],3:[function(e,t){function n(e){this.sba=e,this.config={fetchEnabled:!0,iframeEventsEnabled:!0},this.events=new o,this.eventsStore=[],this.bind("configureAppBridge",this.setConfig.bind(this)),this.bindAppBridgeEvents(e),this.sba.window.onunload=function(){this.consumerReady(!1)}.bind(this)}var i=e("./Bus"),o=e("./Events");n.prototype.setConfig=function(e){if("object"==typeof e)for(var t in e)this.config[t]=e[t]},n.prototype.bindAppBridgeEvents=function(e){this.bind("notificationToken",e.processAppBridgeNotificationToken.bind(e)),this.bind("applicationInfo",e.log.logAppInfo.bind(e.log)),this.bind("OpenedExternalURL",e.log.logOpenedExternalUrl.bind(e.log)),e.bind("loggedIn",e.processNotificationTokenOnLogin.bind(e)),this.bind("remoteNotificationActioned",e.remoteNotificationActioned.bind(e)),this.bind("feedback",e.log.logAppFeedback.bind(e.log)),this.bind("navbar.resendPageURL",e.navbarResendPageUrl.bind(e)),this.bind("navbar.loadPage",e.navbarLoadPage.bind(e)),this.bind("getSsoTransferToken",function(){e.getSsoTransferToken(function(e,t){var n={};e||(n.ssoTransferToken=t),this.trigger("ssoTransferToken",n)}.bind(this))}.bind(this)),this.bindNativeLoginEvents()},n.prototype.bindNativeLoginEvents=function(){var e=this,t=function(t){var n="readyForNativeLogin";return void 0!==t&&e.sba.window.sessionStorage.setItem(n,t),"true"==e.sba.window.sessionStorage.getItem(n)};this.bind("login",function(n){var o=function(){var t=function(){e.sba.bus.unbind(i.Events.APP_LOGIN_READY,t),e.sba.bus.postMessage(e.sba.ui.getMenu().iframe.contentWindow,{type:"Event",event:{name:"submitLogin",data:n}})};e.sba.bus.bind(i.Events.APP_LOGIN_READY,t),e.sba.ui.open("login",null,!0,{},!0,!0)},s=0,r=function(){var e=t();return 1==e?(o(),void 0):(s++,60>s&&setTimeout(r,250),void 0)};r()}),this.sba.bind(i.Events.LOGGED_IN,function(n){0==n.userInteraction&&t(!0),e.trigger(i.Events.LOGGED_IN,n)}),this.sba.bind(i.Events.LOGGED_OUT,function(n){0==n.userInteraction&&t(!0),e.trigger(i.Events.LOGGED_OUT,n)})},n.prototype.consumerReady=function(e){e=e===!1?!1:!0,e&&this.attach(),this.trigger("consumerReady",{ready:e})},n.prototype.myaccountReady=function(e){e=e===!1?!1:!0,this.trigger("myaccountReady",{ready:e})},n.prototype.bind=function(e,t){this.events.bind(e,t)},n.prototype.handleMessage=function(e,t,n){try{return e[t](n),this}catch(i){}},n.prototype.trigger=function(e,t){this.config.fetchEnabled&&this.eventsStore.push({name:e,data:t||{}});var n=JSON.stringify({name:e,data:t});switch(this.config.app){case"android":if("undefined"!=typeof AndroidAppBridge)return this.handleMessage(AndroidAppBridge,"postMessage",n);break;case"windows":if(window.external)return this.handleMessage(window.external,"notify",n);break;default:if("undefined"!=typeof webkit&&webkit.messageHandlers.appBridge)return this.handleMessage(webkit.messageHandlers.appBridge,"postMessage",n)}if(this.config.iframeEventsEnabled){var i="js-frame:"+e+";"+JSON.stringify(t||{});this.loadLocationInTemporaryIframe(i);var i="sbappbridge-2:"+encodeURIComponent(escape(e))+";"+this.encode({name:e,data:t||{}});this.loadLocationInTemporaryIframe(i)}return this},n.prototype.send=function(e,t){return this.trigger(e,t),this},n.prototype.loadLocationInTemporaryIframe=function(e){if(this.sba.getAppName()){var t=this.sba.window.document.createElement("IFRAME");t.style.display="none",t.setAttribute("src",e),this.sba.window.document.documentElement.appendChild(t),t.parentNode.removeChild(t),t=null}},n.prototype.fetch=function(){if(!this.config.fetchEnabled)return"";var e=this.eventsStore.shift();if(!e)return"";if(!e.data)return e.name;var t=JSON.stringify(e.data);return e.name+":"+t},n.prototype.fire=function(e,t){return this.events.fire(e,t),"received:"+e},n.prototype.attach=function(){var e=this.sba.window.top!=this.sba.window.self?this.sba.window.top:this.sba.window;e.appBridge=this},n.prototype.encode=function(e){var t=JSON.stringify(e),n={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t,i,o,s,r,a,u,c="",l=0;for(e=n._utf8_encode(e);l<e.length;)t=e.charCodeAt(l++),i=e.charCodeAt(l++),o=e.charCodeAt(l++),s=t>>2,r=(3&t)<<4|i>>4,a=(15&i)<<2|o>>6,u=63&o,isNaN(i)?a=u=64:isNaN(o)&&(u=64),c=c+this._keyStr.charAt(s)+this._keyStr.charAt(r)+this._keyStr.charAt(a)+this._keyStr.charAt(u);return c},decode:function(e){var t,i,o,s,r,a,u,c="",l=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");l<e.length;)s=this._keyStr.indexOf(e.charAt(l++)),r=this._keyStr.indexOf(e.charAt(l++)),a=this._keyStr.indexOf(e.charAt(l++)),u=this._keyStr.indexOf(e.charAt(l++)),t=s<<2|r>>4,i=(15&r)<<4|a>>2,o=(3&a)<<6|u,c+=String.fromCharCode(t),64!=a&&(c+=String.fromCharCode(i)),64!=u&&(c+=String.fromCharCode(o));return c=n._utf8_decode(c)},_utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var i=e.charCodeAt(n);128>i?t+=String.fromCharCode(i):i>127&&2048>i?(t+=String.fromCharCode(i>>6|192),t+=String.fromCharCode(63&i|128)):(t+=String.fromCharCode(i>>12|224),t+=String.fromCharCode(i>>6&63|128),t+=String.fromCharCode(63&i|128))}return t},_utf8_decode:function(e){for(var t="",n=0,i=c1=c2=0;n<e.length;)i=e.charCodeAt(n),128>i?(t+=String.fromCharCode(i),n++):i>191&&224>i?(c2=e.charCodeAt(n+1),t+=String.fromCharCode((31&i)<<6|63&c2),n+=2):(c2=e.charCodeAt(n+1),c3=e.charCodeAt(n+2),t+=String.fromCharCode((15&i)<<12|(63&c2)<<6|63&c3),n+=3);return t}};return n.encode(t)},t.exports=n},{"./Bus":4,"./Events":6}],4:[function(e,t){function n(e){this.config=e;var t=this;e.window.addEventListener("message",function(){return t.receiveMessage.apply(t,arguments)},!1)}var i=e("./Events");i.call(n.prototype),n.Events=e("./Bus/Events"),n.prototype.receiveMessage=function(e){var t=[n.Events.LOGGED_OUT,n.Events.OPEN_MY_ACCUONT,n.Events.CLOSE_MY_ACCOUNT,n.Events.HEALTH_CHECK_OK];if("string"==typeof e.data&&"myaccount"===e.data.substring(0,9)){var i,o=e.data.slice(9);try{i=JSON.parse(o)}catch(s){throw new Error("Invalid JSON received on message bus")}var r=t.some(function(e){return e===i.event.name}),a=e.origin.match(/https:\/\/(.*)/);return!a&!r?!1:(this.sendMessage(i),void 0)}},n.prototype.sendMessage=function(e){if("Event"===e.type)return this.fire(e.event.name,e.event.data);if("UserEvent"===e.type)return this.fire(e.event.name,{name:e.event.name,user:e.event.data.user,userInteraction:e.event.data.userInteraction});throw new Error("Unknown message type: "+e.type)},n.prototype.postMessage=function(e,t){var n=this.config.scheme+"://"+this.config.host;e.postMessage("myaccount"+JSON.stringify(t),n)},t.exports=n},{"./Bus/Events":5,"./Events":6}],5:[function(e,t){t.exports={OPEN_MY_ACCOUNT:"openMyAccount",CLOSE_MY_ACCOUNT:"closeMyAccount",APP_LOGIN_ATTEMPTED:"appLoginAttempted",APP_LOGIN_READY:"appLoginReady",LOGGED_IN:"loggedIn",LOGGED_OUT:"loggedOut",QUEUE_UP_EVENT:"queueUpEvent",PAGE_READY:"pageReady",SCROLL_TO:"scrollTo",OXI_TOKEN:"oxiToken",SSO_TRANSFER_TOKEN:"ssoTransferToken",BG_VERIFICATION:"bgverification",INITIAL_PAGE:"initialPage",USER_DATA_CHANGE:"userDataChange",NAVIGATE:"navigate",SHOW_MODAL_DIALOG:"showModalDialog",SET_LOADING_OVERLAY:"setLoadingOverlay",MYACCOUNT_PAGE_READY:"myaccountPageReady",HEALTH_CHECK_OK:"healthCheckOk",HAS_COOKIES:"hasCookies",PAGE_RENDERED:"pageRendered",REDEEM_CODE:"redeemCode",GET_DATA_FOR_DEPOSIT:"getDataForDeposit",GET_SSO_TRANSFER_TOKEN:"getSsoTransferToken",APPBRIDGE_TRIGGER:"appbridgeTrigger",ALLOW_REFRESH:"allowRefresh",OPTIN_TRIGGER:"optinTrigger",FULL_REGISTRATION:"fullRegistrationComplete",DEPOSIT_COMPLETE:"depositComplete",WITHDRAWAL_COMPLETE:"withdrawalComplete",REDEEM_PROMO_CODE:"redeemPromoCode",SELF_EXCLUSIONS_UPDATE:"selfExclusionsUpdate",COOL_OFF_UPDATE:"coolOffUpdate",PREFERENCES_UPDATE:"preferencesUpdate",AGE_VERIFICATION:"ageVerificationComplete",SEND_PAGE_URL:"sendPageUrl"}
},{}],6:[function(e,t){function n(){this.hasBoundEvent=function(e){return void 0!==this.callback&&void 0!==this.callback[e]&&this.callback[e].length?!0:!1},this.bind=function(e,t){return void 0===this.callback&&(this.callback={}),void 0===this.callback[e]&&(this.callback[e]=[]),this.callback[e].push(t),this},this.unbind=function(e,t){if(void 0===this.callback&&(this.callback={}),t)for(var n=0,i=this.callback[e].length;i>n;n++)this.callback[e][n]===t&&delete this.callback[e][n];else delete this.callback[e];return this},this.unbindLast=function(e){return void 0===this.callback&&(this.callback={}),this.callback[e]&&this.callback[e].pop(),this},this.fire=function(e,t){if(void 0===this.callback&&(this.callback={}),void 0!==this.callback[e]){for(var n in this.callback[e])this.callback[e].hasOwnProperty(n)&&this.callback[e][n](t);return this}}}t.exports=n},{}],7:[function(e,t){function n(e,t){this.config=e,this.sba=t}var i=e("./Bus");n.prototype.checkDeeplink=function(e){var t=e||this.sba.affiliates.getQueryVar(this.config.deeplinkParam);switch("string"==typeof t&&(t=t.toLowerCase()),t){case"account":this.sba.openMyAccount(this.complete());break;case"addcard":this.sba.openAddCard(this.complete());break;case"applypromotion":case"promotion":this.sba.openPromotion(this.complete());break;case"bankinghistory":this.sba.openBankingHistory(this.complete());break;case"bettinghistory":this.sba.openBettingHistory(this.complete());break;case"deposit":this.sba.openDeposit(this.complete());break;case"quickdeposit":this.sba.openQuickDeposit(this.complete());break;case"completedeposit":"loggedIn"==this.sba.getLastLoginState()&&this.sba.openCompleteDeposit(this.complete());break;case"gaminghistory":this.sba.openGamingHistory(this.complete());break;case"login":"loggedIn"==this.sba.getLastLoginState()?this.complete():this.sba.openLogin(this.complete());break;case"managepaymentmethods":case"paymentmethods":this.sba.openManagePaymentMethods(this.complete());break;case"recovermenu":case"recover":"loggedIn"==this.sba.getLastLoginState()?this.complete():this.sba.openRecoverMenu(this.complete());break;case"recoverpin":"loggedIn"==this.sba.getLastLoginState()?this.complete():this.sba.openRecoverPin(this.complete());break;case"recoveruser":"loggedIn"==this.sba.getLastLoginState()?this.complete():this.sba.openRecoverUser(this.complete());break;case"registration":case"register":"loggedIn"==this.sba.getLastLoginState()?this.complete():this.sba.openRegistration(this.complete(),t,!0);break;case"resettemppin":"loggedIn"==this.sba.getLastLoginState()?this.complete():this.sba.openResetTempPin(this.complete());break;case"unlockaccount":"loggedIn"==this.sba.getLastLoginState()?this.complete():this.sba.openUnlockAccount(this.complete());break;case"upgradereg":this.sba.openUpgradeReg(this.complete());break;case"verification":this.sba.openVerification(this.complete());break;case"withdrawal":this.sba.openWithdrawal(this.complete());break;case"faq":this.sba.openFaq(this.complete());break;case"changePin":this.sba.openChangePin(this.complete());break;default:this.complete()}},n.prototype.complete=function(){this.sba.fire(i.Events.INITIAL_PAGE)},t.exports=n},{"./Bus":4}],8:[function(e,t){function n(e){this.ui=e,this.cachedIsIOS43Device=null,this.loadingBox=this.ui.createElement("div"),this.loadingBox.className="sba-loading",this.loadingBox.innerHTML="<p>Loading&hellip;</p>",this.ui.getElement("body").appendChild(this.loadingBox)}e("./UI/Styles");n.prototype.show=function(){this.loadingBox.style.display="block"},n.prototype.hide=function(){this.loadingBox.style.display="none"},t.exports=n},{"./UI/Styles":14}],9:[function(e,t){function n(e){this.sba=e}n.prototype.logAppInfo=function(e){var t=this.sba.getAppName();if(t){var n={appName:t,networkType:e.NetworkType||null,appVersion:e.appVersion||null,deviceName:e.deviceName||null,deviceVersion:e.deviceVersion||null};e.timeDeltas&&"object"==typeof e.timeDeltas&&(n.locationCheckTime=e.timeDeltas.LocationCheck||null,n.networkCheckTime=e.timeDeltas.NetworkCheck||null,n.siteLoadTime=e.timeDeltas.SiteLoad||null,n.applicationLoadTime=e.timeDeltas.applicationLoadTime||null),e.InstalledApps&&"object"==typeof e.InstalledApps&&(n.installedApps=e.InstalledApps.toString());var i=[{type:"businessAnonymous",name:"app.info."+t.toLowerCase(),data:n}];this.sendLogEvents(i)}},n.prototype.logAppFeedback=function(e){var t=this.sba.getAppName();if(t){this.sba.getLoginState(function(t,n){t||(userInfo=n.user,userInfo&&userInfo.customerId&&(e.customerId=userInfo.customerId))});var n=[{type:"business",name:"app.feedback."+t.toLowerCase(),data:e}];this.sendLogEvents(n)}},n.prototype.logOpenedExternalUrl=function(e){var t=this.sba.getAppName();if(t){var n={appName:t,appVersion:e.appVersion||null,applicationInstallToken:e.applicationInstallToken||null,deviceName:e.deviceName||null,deviceVersion:e.deviceVersion||null,externalUrl:e.externalUrl||null,urlOpened:e.urlOpened||null},i=[{type:"business",name:"app.externalUrl."+t.toLowerCase(),data:n}];this.sendLogEvents(i)}},n.prototype.sendLogEvents=function(e,t){if("object"==typeof e){var n=this.sba.config.scheme+"://"+this.sba.config.host+"/secure/identity/app/log-events",i=this.createRequest(n,t);i.send("events="+encodeURIComponent(JSON.stringify(e)))}},n.prototype.createRequest=function(e,t){var n=new XMLHttpRequest;return n.open("POST",e,!0),n.setRequestHeader("Content-type","application/x-www-form-urlencoded"),n.onreadystatechange=function(){4===n.readyState&&"function"==typeof t&&t(n)},n},t.exports=n},{}],10:[function(e,t){function n(e,t,n){this.ui=e,this.bus=n,this.container=t,this.isVisible=!1,this.initContainer(),this.initWrapper(),this.initIframe()}var i=e("./Bus"),o=e("./UI/Styles");n.prototype.initContainer=function(){this.container||(this.container=this.ui.createElement("div"),this.container.className="sba-container",this.ui.getElement("body").appendChild(this.container)),this.container.style.cssText=o.menu},n.prototype.initWrapper=function(){var e=this.ui.createElement("div");e.className="sba-wrapper",this.container.appendChild(e),this.wrapper=e},n.prototype.initIframe=function(){var e=this.ui.createElement("iframe");e.className="sba-iframe",e.name="SkyBetAccount",e.id="SkyBetAccount",e.src=this.ui.getUrl("loginState"),e.scrolling="auto",e.addEventListener("mousedown",function(e){e.preventBubble()},!0),this.iframe=e,this.wrapper.appendChild(this.iframe)},n.prototype.redirect=function(e,t,n,o){var s=this,r=e.match(/^(http|https):\/\//),a=e;if(r||(a=this.ui.getUrl(e,null,o)),t){var u=function(){t(null,a),s.iframe.removeEventListener("load",u,!1)};this.iframe.addEventListener("load",u,!1)}return!n&&this.url&&this.isSameUrl(this.url,a,!0)?(this.ui.ready(),t&&t(null,a),void 0):(n||!this.url||this.url===this.ui.getUrl("loginState")?(n?this.iframe.contentWindow.location.replace(a):this.iframe.src=a,this.url=a):(this.bus.postMessage(this.iframe.contentWindow,{type:"Event",event:{name:"clientSideRedirect",data:this.ui.getUrl(e,null,o,!0)}}),this.bus.bind(i.Events.PAGE_READY,function(){t&&t(null,a),s.bus.unbindLast(i.Events.PAGE_READY)})),void 0)},n.prototype.hide=function(){this.isVisible=!1,this.ui.scrollTo(0)},n.prototype.show=function(){this.isVisible=!0,this.ui.scrollTo(0),this.bus.fire(i.Events.OPEN_MY_ACCOUNT)},n.prototype.isSameUrl=function(e,t,n){return n?(c=-1===e.indexOf("?")?e:e.substring(0,e.indexOf("?")),d=-1===t.indexOf("?")?t:t.substring(0,t.indexOf("?")),c===d):e===t},t.exports=n},{"./Bus":4,"./UI/Styles":14}],11:[function(e,t){function n(e,t){this.config={dialog:{title:"Are you sure?",description:"Closing the menu will lose any information provided.",buttons:[{label:"No, keep menu"},{label:"Yes, close menu",aux:"close"}],level:"info",doneCallback:this.closeMyAccountDialogHandler.bind(this),isConsumerDialog:!0}},this.ui=e,this.loadingOverlay=t?!0:!1,this.initOverlay()}{var i=e("./Bus");e("./UI/Styles")}n.prototype.updateConfig=function(e){this.config=$.extend(!0,this.config,e)},n.prototype.initOverlay=function(){var e=this.ui.createElement("div");if(e.className="sba-overlay",this.loadingOverlay&&(e.id="loading-overlay"),!this.loadingOverlay){var t=this;e.addEventListener("mousedown",function(e){t.mouseDownHandler(e)},!1)}this.ui.getElement("body").appendChild(e),this.overlay=e},n.prototype.mouseDownHandler=function(){var e=this.ui.getMenu().url,t=["/secure/identity/m/withdrawal","/secure/identity/m/quick-deposit","/secure/identity/m/verification","/secure/identity/m/register","/secure/identity/m/recover/pin","/secure/identity/m/recover/user","/secure/identity/m/reset-temp-pin","/secure/identity/m/unlock-account"],n=t.some(function(t){return-1!==e.indexOf(t)?!0:!1});return!1===n?(bus.fire(i.Events.CLOSE_MY_ACCOUNT),void 0):(this.ui.fire(i.Events.SHOW_MODAL_DIALOG,this.config.dialog),void 0)},n.prototype.closeMyAccountDialogHandler=function(e){e.aux&&"close"===e.aux&&this.ui.close()},n.prototype.getElement=function(){return this.overlay},n.prototype.resize=function(){},t.exports=n},{"./Bus":4,"./UI/Styles":14}],12:[function(e,t){function n(e,t,n,i){this.window=e,this.bus=t,this.getUrl=n,this.sba=i,this.overlay=new a(this),this.loadingOverlay=new a(this,!0),this.loadingBox=new s(this),this.isOpen=!1,this.isPreloading=!1,this.onPreloadCallbacks=[],this.loginTokenTimeout=6e5,this.addStyles();var o=this;this.window.addEventListener("orientationchange",function(e){o.scrollTo("top"),t.postMessage(o.getMenu().iframe.contentWindow,{type:"Event",event:{name:"orientationChange",data:e.currentTarget.orientation}})},!1)}var o=e("./Events"),s=e("./LoadingBox"),r=e("./Menu"),a=e("./Overlay");o.call(n.prototype),n.prototype.addStyles=function(){var t="",n=e("./UI/Styles"),i=this.window.document.createElement("style");i.setAttribute("type","text/css");for(var o in n)t+=n[o];i.styleSheet&&!i.sheet?i.styleSheet.cssText=t:i.appendChild(this.window.document.createTextNode(t)),this.getElement("head").appendChild(i)},n.prototype.getMenu=function(){return this.menu||(this.menu=new r(this,null,this.bus)),this.menu},n.prototype.getElement=function(e){return"body"===e?this.window.document.body:"head"===e?this.window.document.getElementsByTagName("head")[0]:"html"===e?this.window.document.documentElement:this.window.document.getElementById(e)},n.prototype.createElement=function(e){return this.window.document.createElement(e)},n.prototype.createTextNode=function(e){return this.window.document.createTextNode(e)},n.Events=e("./UI/Events"),n.Styles=e("./UI/Styles"),n.prototype.getViewportHeight=function(){var e=this.window.innerHeight;return this.window.top&&(e=this.window.top.innerHeight),void 0===e&&(e=window.document.body.clientHeight),e},n.prototype.getViewportYOffset=function(){var e=this.window.pageYOffset;return void 0===e&&(e=window.document.body.scrollTop),e},n.prototype.getPageHeight=function(){var e=Math.max(this.window.document.documentElement.offsetHeight,this.getViewportHeight());return isNaN(e)&&(e=this.window.document.documentElement.clientHeight),e},n.prototype.open=function(e,t,i,o,s,r){if(r!==!0&&this.showLoadingOverlay(),this.isPreloading)return this.onPreload(function(){this.open(e,t,i,o,s,r)}.bind(this)),void 0;if(("login"===e&&this.getMenu().url===this.getUrl(e)&&this.isLoginTokenExpired()||"logout"===e)&&(i=!0),s===!0&&(i=!0),this.sba.config.allowsRefresh===!0&&(i=!0,this.sba.config.allowsRefresh=!1),!this.sba.config.hasCookies){var a=this.sba.window.top.location,u=a.protocol+"//"+a.host+a.pathname+a.search;u+=a.search.length>0?"&":"?",-1==u.search(this.sba.config.deeplinkParam+"=")&&(u+=this.sba.config.deeplinkParam+"="+e),u+=a.hash;var c=this.sba.getUrl("fullScreenRedirect","static")+"returnUrl="+escape(u);this.sba.window.top.location.replace(c)}if(e){var l=this,p=function(){l.fire(n.Events.RENDERED),t&&t()};this.getMenu().redirect(e,p,i,o)}this.fire(n.Events.OPEN),this.isOpen=!0},n.prototype.preload=function(e,t){e&&!this.isOpen&&("function"==typeof t&&this.onPreload(t),this.isPreloading=!0,this.getMenu().redirect(e,null,!0))},n.prototype.onPreload=function(e){this.onPreloadCallbacks.push(e)},n.prototype.applyOnPreloadCallbacks=function(){this.isPreloading=!1;for(i in this.onPreloadCallbacks)this.onPreloadCallbacks[i]();this.onPreloadCallbacks=[]},n.prototype.close=function(){this.getElement("body").removeEventListener("touchmove",this.onTouchMove),this.removeClass(this.getElement("html"),"sba-open"),this.fire(n.Events.CLOSE),this.isOpen=!1},n.prototype.showLoadingOverlay=function(e){this.loadingBox.show(e)},n.prototype.hideLoadingOverlay=function(){this.loadingBox.hide()},n.prototype.onTouchMove=function(e){e.preventDefault()},n.prototype.ready=function(){this.getElement("body").addEventListener("touchmove",this.onTouchMove),this.addClass(this.getElement("html"),"sba-open"),this.hideLoadingOverlay(),this.getMenu().show()},n.prototype.scrollTo=function(e){"undefined"!=typeof this.window.top&&"function"==typeof this.window.top.scroll?this.window.top.scroll(0,e):"function"==typeof this.window.scroll&&this.window.scroll(0,e)},n.prototype.isLoginTokenExpired=function(){if(!this.loginToken)return!1;var e=(new Date).getTime()-this.loginToken;return e>this.loginTokenTimeout},n.prototype.addClass=function(e,t){this.hasClass(e,t)||(e.className+=" "+t)},n.prototype.removeClass=function(e,t){if(this.hasClass(e,t)){var n=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(n," ")}},n.prototype.hasClass=function(e,t){return e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))},t.exports=n},{"./Events":6,"./LoadingBox":8,"./Menu":10,"./Overlay":11,"./UI/Events":13,"./UI/Styles":14}],13:[function(e,t){t.exports={OPEN:"UI.Open",CLOSE:"UI.Close",RENDERED:"UI.Rendered"}},{}],14:[function(e,t){t.exports=[".sba-open, .sba-open body {        height: 100%;        overflow: hidden;    }",".sba-open body {        position: static;        margin-left: -320px;        margin-right: 320px;    }",".sba-iframe {        background-color: white;        border: 0;        display: block;        height: 100%;        width: 100%;    }",".android-app .sba-container {        display: none;    }",".sba-container {        height: 1px;        position: absolute;        right: 0;        top: 0;        width: 320px;        color: #fff;        z-index: -1;        overflow: hidden;        -webkit-box-shadow: 0 0 10px rgba(50, 50, 50, 1);        -moz-box-shadow: 0 0 10px rgba(50, 50, 50, 1);        box-shadow: 0 0 10px rgba(50, 50, 50, 1);    }",".sba-open .sba-container {        height: 100%;        z-index: 98;    }",".android-app.sba-open .sba-container {        display: block;    }",".sba-wrapper {        height: 100%;        overflow-x: hidden;        overflow-y: auto;        left: 340px;        position: relative;        right: 0;        top: 0;        width: 100%;        -webkit-overflow-scrolling: touch;        z-index: 1;    }",".sba-open .sba-wrapper {        left: 0;    }",".sba-overlay {        bottom: 0;        display: none;        height: 100%;        left: 0;        position: absolute;        right: 0;        top: 0;        z-index: -1;        -webkit-tap-highlight-color: rgba(0, 0, 0, 0);    }",".sba-open .sba-overlay {        display: block;        z-index: 40;    }",'.sba-loading {        background: #fff;        border: 1px solid #cccccc;        border-radius: 8px;        -webkit-border-radius: 8px;        -mox-border-radius: 8px;        -webkit-box-shadow: -2px 0px 16px rgba(50, 50, 50, 0.75);        -moz-box-shadow: -2px 0px 16px rgba(50, 50, 50, 0.75);        box-shadow: -2px 0px 16px rgba(50, 50, 50, 0.75);        -webkit-box-sizing: border-box;        -moz-box-sizing: border-box;        box-sizing: border-box;        color: #505050;        display: none;        font-size: 14px;        font-family: "Helvetica Neue", Arial, sans-serif;        font-weight: bold;        left: 50%;        height: auto;        margin-left: -145px;        margin-top: -50px;        padding: 40px;        position: fixed;        text-align: center;        top: 50%;        width: 290px;        z-index: 99;    }',".sba-loading p {        margin: 0;    }",".sba-spinner {        height: 40px;        left: 50%;        margin-left: -20px;        position: relative;        width: 40px;        background-size: 40px;        top: 0;        transform: translate3d(0,0,0);    }"]},{}]},{},[1])(1)});
